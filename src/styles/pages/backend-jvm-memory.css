.jvm-diagram { width: min(100%, 780px); margin: 0 auto; }
.jvm-scene { display: grid; gap: 14px; }
.jvm-svg { width: 100%; height: auto; display: block; }

.jvm-title { text-anchor: middle; font-size: 11px; font-weight: 700; font-family: "SF Mono", "Fira Code", monospace; fill: rgba(0,0,0,0.4); }

/* Heap regions */
.jvm-region { stroke-width: 1.2; }
.jvm-region--eden { fill: rgba(42,111,107,0.04); stroke: rgba(42,111,107,0.25); }
.jvm-region--s { fill: rgba(76,120,168,0.04); stroke: rgba(76,120,168,0.25); }
.jvm-region--old { fill: rgba(210,100,42,0.04); stroke: rgba(210,100,42,0.25); }
.jvm-region-label { font-size: 9px; font-weight: 700; font-family: "SF Mono", "Fira Code", monospace; }
.jvm-rl--eden { fill: rgba(42,111,107,0.6); }
.jvm-rl--s { fill: rgba(76,120,168,0.6); }
.jvm-rl--old { fill: rgba(210,100,42,0.6); }

/* Objects */
.jvm-obj { fill: rgba(42,111,107,0.12); stroke: rgba(42,111,107,0.4); stroke-width: 1.2; animation: jvmObjPulse 2s ease-in-out infinite; }
.jvm-obj--old { fill: rgba(210,100,42,0.12); stroke: rgba(210,100,42,0.4); }
.jvm-obj-text { text-anchor: middle; font-size: 9px; font-weight: 700; fill: rgba(0,0,0,0.6); }

/* Arrows */
.jvm-arr { stroke-width: 1.5; stroke-linecap: round; }
.jvm-arr--teal { stroke: rgba(42,111,107,0.5); }
.jvm-arr--orange { stroke: rgba(210,100,42,0.5); }
.jvm-arr--meta { stroke: rgba(140,80,180,0.5); }
.jvm-arr--gc { stroke: rgba(56,142,60,0.5); }

/* Stack */
.jvm-stack-bg { fill: rgba(42,111,107,0.03); stroke: rgba(42,111,107,0.15); stroke-width: 1; }
.jvm-frame { fill: rgba(42,111,107,0.08); stroke: rgba(42,111,107,0.25); stroke-width: 1.2; }
.jvm-frame--top { fill: rgba(42,111,107,0.15); stroke: rgba(42,111,107,0.6); animation: jvmFramePulse 2s ease-in-out infinite; }
.jvm-frame-name { font-size: 11px; font-weight: 700; font-family: "SF Mono", "Fira Code", monospace; fill: rgba(42,111,107,0.85); }
.jvm-frame-vars { text-anchor: end; font-size: 9px; font-family: "SF Mono", "Fira Code", monospace; fill: rgba(0,0,0,0.35); }
.jvm-pop-label { text-anchor: middle; font-size: 10px; font-weight: 600; fill: rgba(210,100,42,0.7); }

/* Metaspace */
.jvm-meta-loader { fill: rgba(140,80,180,0.08); stroke: rgba(140,80,180,0.3); stroke-width: 1.2; }
.jvm-meta-loader-text { text-anchor: middle; font-size: 10px; font-weight: 700; fill: rgba(140,80,180,0.8); }
.jvm-meta-class { fill: rgba(140,80,180,0.06); stroke: rgba(140,80,180,0.2); stroke-width: 1; animation: jvmMetaFade 3s ease-in-out infinite; animation-delay: calc(var(--meta-i,0) * 0.4s); }
.jvm-meta-text { text-anchor: middle; font-size: 10px; font-weight: 600; font-family: "SF Mono", "Fira Code", monospace; fill: rgba(140,80,180,0.7); }

/* GC */
.jvm-gc-heap { fill: rgba(0,0,0,0.02); stroke: rgba(0,0,0,0.1); stroke-width: 1; }
.jvm-gc-node { stroke-width: 1.5; transition: fill 0.4s, stroke 0.4s, opacity 0.4s; }
.jvm-gc-node--alive { fill: rgba(56,142,60,0.1); stroke: rgba(56,142,60,0.4); }
.jvm-gc-node--dead { fill: rgba(180,60,60,0.08); stroke: rgba(180,60,60,0.3); stroke-dasharray: 4 2; }
.jvm-gc-node--marking { animation: jvmMarkPulse 1.4s ease-in-out infinite; }
.jvm-gc-node--swept { opacity: 0.15; }
.jvm-gc-text { text-anchor: middle; dominant-baseline: central; font-size: 11px; font-weight: 700; fill: rgba(0,0,0,0.5); }
.jvm-gc-text--swept { fill: rgba(0,0,0,0.15); text-decoration: line-through; }
.jvm-gc-roots { font-size: 9px; font-weight: 700; font-family: "SF Mono", "Fira Code", monospace; fill: rgba(56,142,60,0.7); text-anchor: middle; }
.jvm-gc-bar { fill: rgba(210,100,42,0.6); }

/* State panel */
.jvm-ds { padding: 10px 14px; border-radius: 12px; border: 1px solid var(--line); background: rgba(255,255,255,0.8); display: flex; align-items: flex-start; gap: 10px; }
.jvm-ds__label { font-size: 11px; font-weight: 700; font-family: "SF Mono", "Fira Code", monospace; padding: 3px 8px; border-radius: 6px; white-space: nowrap; flex-shrink: 0; }
.jvm-ds--heap .jvm-ds__label { background: rgba(42,111,107,0.1); color: rgba(42,111,107,0.9); }
.jvm-ds--stack .jvm-ds__label { background: rgba(42,111,107,0.1); color: rgba(42,111,107,0.9); }
.jvm-ds--meta .jvm-ds__label { background: rgba(140,80,180,0.1); color: rgba(140,80,180,0.9); }
.jvm-ds--gc .jvm-ds__label { background: rgba(210,100,42,0.1); color: rgba(210,100,42,0.9); }
.jvm-ds__items { display: flex; flex-wrap: wrap; gap: 6px; }
.jvm-ds__step { font-size: 11px; font-family: "SF Mono", "Fira Code", monospace; padding: 3px 8px; border-radius: 6px; border: 1px solid var(--line); background: #fff; opacity: 0.35; transition: opacity 0.3s, background 0.3s, border-color 0.3s, color 0.3s; }
.jvm-ds__step--past { opacity: 0.55; }
.jvm-ds--heap .jvm-ds__step--active { opacity: 1; background: rgba(42,111,107,0.08); border-color: rgba(42,111,107,0.3); color: rgba(42,111,107,0.9); }
.jvm-ds--stack .jvm-ds__step--active { opacity: 1; background: rgba(42,111,107,0.08); border-color: rgba(42,111,107,0.3); color: rgba(42,111,107,0.9); }
.jvm-ds--meta .jvm-ds__step--active { opacity: 1; background: rgba(140,80,180,0.08); border-color: rgba(140,80,180,0.3); color: rgba(140,80,180,0.9); }
.jvm-ds--gc .jvm-ds__step--active { opacity: 1; background: rgba(210,100,42,0.08); border-color: rgba(210,100,42,0.3); color: rgba(210,100,42,0.9); }

/* Keyframes */
@keyframes jvmObjPulse {
  0%, 100% { filter: none; }
  50% { filter: drop-shadow(0 0 4px rgba(42,111,107,0.3)); }
}
@keyframes jvmFramePulse {
  0%, 100% { stroke: rgba(42,111,107,0.4); }
  50% { stroke: rgba(42,111,107,0.8); filter: drop-shadow(0 0 6px rgba(42,111,107,0.25)); }
}
@keyframes jvmMetaFade {
  0%, 100% { opacity: 0.5; }
  40%, 60% { opacity: 1; stroke: rgba(140,80,180,0.4); }
}
@keyframes jvmMarkPulse {
  0%, 100% { stroke: rgba(56,142,60,0.3); fill: rgba(56,142,60,0.06); }
  50% { stroke: rgba(56,142,60,0.8); fill: rgba(56,142,60,0.18); filter: drop-shadow(0 0 6px rgba(56,142,60,0.3)); }
}

@media (max-width: 640px) {
  .jvm-title { font-size: 9px; }
  .jvm-obj-text { font-size: 7px; }
  .jvm-frame-vars { display: none; }
  .jvm-ds__step { font-size: 9px; padding: 2px 6px; }
}
